# Media Events System - User Guide

## Что это такое?

Media Events System позволяет показывать изображения, видео и проигрывать звуки в вашем стриминговом оверлее при различных событиях:

- Когда кто-то получает предмет в гаче
- Когда срабатывает триггер (награда channel points, команда)
- И другие события

## Быстрый старт

### 1. Откройте редактор медиа-оверлея

В настройках приложения перейдите в раздел **Media Overlay / Медиа-оверлей** (кнопка с иконкой видео).

### 2. Создайте группу отображения

Группа определяет *где* на экране будет появляться медиа:

1. Нажмите **"+ Add Group / + Добавить группу"** в левой панели
2. Перетащите группу на нужную позицию в превью
3. Настройте размеры и параметры анимации

### 3. Создайте медиа-событие

Медиа-событие определяет *что* показывать:

1. Перейдите в настройки **Gacha / Гача** или **Triggers / Триггеры**
2. При редактировании предмета/триггера найдите секцию **Media Events / Медиа-события**
3. Нажмите **"+ Add Media / + Добавить медиа"**
4. Загрузите файл или укажите URL
5. Настройте подпись и стили

### 4. Добавьте оверлей в OBS

1. Нажмите кнопку **"Open in Browser / Открыть в браузере"** в редакторе
2. Скопируйте URL из адресной строки
3. В OBS добавьте **Browser Source**
4. Вставьте URL и установите размер (1920x1080 рекомендуется)

## Группы отображения

### Параметры группы

| Параметр | Описание |
|----------|----------|
| **Name / Название** | Название группы для вашего удобства |
| **Enabled / Включено** | Включена ли группа |
| **Position / Позиция** | X и Y координаты на экране |
| **Size / Размер** | Размеры области (0 = авто) |
| **Max Size / Макс. размер** | Максимальные размеры |
| **Media Size / Размер медиа** | Размер медиа внутри области |
| **Content Scale / Масштаб** | Масштаб контента (1 = 100%) |

### Режимы размещения (Placement / Размещение)

- **Fixed / Фиксированный** - медиа появляется точно в указанной позиции
- **Random / Случайный** - случайная позиция в пределах группы, опционально с поворотом
- **Stack / Стопка** - медиа выстраиваются в ряд (горизонтально или вертикально)

### Якорь (Anchor / Привязка)

Определяет точку привязки контента:

```
top-left     top      top-right
    ┌─────────┬─────────┐
    │         │         │
left├─────── center ────┤right
    │         │         │
    └─────────┴─────────┘
bottom-left  bottom  bottom-right
```

### Анимации (Animation / Анимация)

**Входящие (In):** fade, slide-up, slide-down, slide-left, slide-right, scale, bounce

**Исходящие (Out):** те же варианты

### Режимы очереди (Queue Mode / Режим очереди)

- **Sequential / Последовательно** - медиа показываются по очереди
- **Replace / Замена** - новое медиа заменяет текущее
- **Stack / Стопка** - несколько медиа показываются одновременно

## Медиа-события

### Создание медиа-события

1. **Name / Имя** - название для идентификации в списках
2. **Group / Группа** - в какой группе показывать (опционально)
3. **Type / Тип** - изображение, видео или аудио
4. **Source / Источник** - загрузить файл или указать URL
5. **Caption / Подпись** - текст, который появится с медиа

### Переменные в подписях

В зависимости от контекста доступны разные переменные:

**Для гачи:**

| Переменная | Описание | Пример |
|------------|----------|--------|
| `${user}` | Имя пользователя | `NightOwl` |
| `${item}` | Название предмета | `Legendary Sword` |
| `${rarity}` | Редкость (число) | `5` |
| `${stars}` | Звёзды | `⭐⭐⭐⭐⭐` |
| `${pullNumber}` | Номер попытки | `76` |

Пример: `${user} получил ${item}! ${stars}`

**Для триггеров:**

| Переменная | Описание |
|------------|----------|
| `${user}` | Кто активировал |
| `${target}` | Цель (для команд с @упоминанием) |
| `${reward}` | Название награды |
| `${reward_cost}` | Стоимость награды |
| `${raider}` | Рейдящий канал |
| `${viewers}` | Количество зрителей |

### Стили подписи

- **Font Size / Размер шрифта**
- **Font Family / Семейство шрифта**
- **Color / Цвет текста**
- **Text Shadow / Тень текста**
- **Align / Выравнивание** (left, center, right)
- **Position / Позиция** (top, bottom, overlay)
- **Background / Фон подписи**
- **Padding / Отступы**

### Длительность показа (Duration / Длительность)

- Укажите **0** для использования длительности по умолчанию из группы
- Или укажите конкретное время в секундах

## Медиа-библиотека

### Поддерживаемые форматы

**Изображения:** JPG, PNG, GIF, WebP, SVG

**Видео:** MP4, WebM, MOV

**Аудио:** MP3, WAV, OGG, FLAC, AAC, M4A

### Загрузка файлов

1. В редакторе медиа-события нажмите **"Choose from Library / Выбрать из библиотеки"**
2. Нажмите **"Upload / Загрузить"** или перетащите файл
3. Файл появится в библиотеке

### Организация

Файлы автоматически сортируются по типу:
- Images / Изображения
- Videos / Видео
- Audio / Аудио

## Интеграция с гачей

### Привязка медиа к предмету

1. Откройте настройки **Gacha / Гача**
2. Перейдите на вкладку **Items / Предметы**
3. Нажмите на предмет для редактирования
4. В секции **Media Events / Медиа-события** нажмите **"+ Add Media / + Добавить медиа"**
5. Выберите существующее событие или создайте новое

К одному предмету можно привязать до 2 медиа-событий.

### Когда показывается медиа

Когда пользователь использует команду `!wish` (или вашу команду гачи) и получает предмет с привязанным медиа:

1. В чат отправляется сообщение о результате
2. В оверлее показывается медиа с подписью
3. Переменные автоматически заполняются данными

## Интеграция с триггерами

### Добавление медиа к триггеру

1. Откройте настройки **Triggers / Триггеры**
2. Создайте или отредактируйте триггер
3. В действиях добавьте **Show Media / Показать медиа**
4. Выберите медиа-событие

### Примеры использования

**При активации награды channel points:**
- Триггер: награда "Celebrate"
- Действие: показать GIF с конфетти

**При рейде:**
- Триггер: событие рейда
- Действие: показать приветственную анимацию

## Debug Mode / Режим отладки

Для отладки позиционирования групп:

1. В редакторе **Media Overlay / Медиа-оверлей** включите переключатель **"Debug Mode / Режим отладки"** в верхней панели
2. В оверлее будут показаны:
   - Границы групп (пунктирная рамка)
   - Направляющие разрешения (1080p, 720p)
   - Координаты групп

## Советы и лучшие практики

### Производительность

1. **Оптимизируйте изображения** - используйте WebP для меньшего размера
2. **Короткие анимации** - 200-300ms работают лучше
3. **Режим Replace** - для частых событий используйте режим замены

### Дизайн

1. **Тестируйте на разных разрешениях** - используйте custom resolution frame
2. **Не перегружайте экран** - одна группа для важных событий достаточно
3. **Контрастные подписи** - используйте тень или фон для читаемости

### Организация

1. **Называйте группы понятно** - "Gacha Rewards", "Alert Center"
2. **Группируйте похожие медиа** - все гача-медиа в одной группе
3. **Используйте одинаковые стили** - для единообразного вида

## Устранение неполадок

### Медиа не показывается

1. Проверьте, что группа включена (**Enabled**)
2. Проверьте подключение WebSocket (индикатор в углу оверлея)
3. Убедитесь, что URL оверлея правильный

### Нет звука

1. Проверьте, что файл действительно аудио
2. Убедитесь, что Browser Source в OBS не заглушен
3. Проверьте громкость в OBS

### Неправильное позиционирование

1. Проверьте размеры Browser Source в OBS
2. Используйте Debug Mode для визуализации групп
3. Убедитесь, что Anchor настроен правильно

### Медиа обрезается

1. Увеличьте Max Width / Max Height группы
2. Или уменьшите Content Scale
3. Проверьте размер исходного файла

## Примеры конфигураций

### Гача с эффектами редкости

**Группа:**
- Position: центр экрана
- Animation In: bounce, Animation Out: fade
- Duration: 5s

**Медиа для 5-star:**
- Золотой эффект GIF
- Caption: `${stars} ${user} получил ${item}!`
- Font: крупный, золотой цвет

**Медиа для 4-star:**
- Фиолетовый эффект
- Caption: `${user}: ${item}`
- Font: средний

### Алерты подписчиков

**Группа:**
- Position: верх экрана
- Placement: Fixed
- Queue: Sequential

**Медиа:**
- Анимированный баннер
- Caption: `Спасибо за подписку, ${user}!`
- Duration: 4s

### Звуковые алерты

**Группа:**
- Position: любая (не видима для аудио)
- Queue: Sequential с паузой

**Медиа:**
- Audio файлы
- Caption: пустой или для отладки
- Duration: длина аудио
